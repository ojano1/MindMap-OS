/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
If you want to view the source, see the repository of this plugin.
*/
"use strict";var W=Object.defineProperty;var gt=Object.getOwnPropertyDescriptor;var ht=Object.getOwnPropertyNames;var ft=Object.prototype.hasOwnProperty;var wt=(t,e)=>{for(var a in e)W(t,a,{get:e[a],enumerable:!0})},bt=(t,e,a,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of ht(e))!ft.call(t,o)&&o!==a&&W(t,o,{get:()=>e[o],enumerable:!(n=gt(e,o))||n.enumerable});return t};var kt=t=>bt(W({},"__esModule",{value:!0}),t);var me={};wt(me,{default:()=>H});module.exports=kt(me);var S=require("obsidian");var z=require("obsidian");var $=require("obsidian");function f(t=new Date){let e=t.getTimezoneOffset();return new Date(t.getTime()-e*6e4).toISOString().slice(0,10)}function xt(t=new Date){return t.toLocaleDateString(void 0,{weekday:"long"})}function Mt(t=new Date){return t.toLocaleDateString(void 0,{month:"short"})}function Tt(t=new Date){return t.getFullYear()}function At(t=new Date){return Math.floor(t.getMonth()/3)+1}function vt(t=new Date){let e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()));e.setUTCDate(e.getUTCDate()+4-(e.getUTCDay()||7));let a=new Date(Date.UTC(e.getUTCFullYear(),0,1));return Math.ceil(((+e-+a)/864e5+1)/7)}function _(t,e,a=new Date){let n=f(a),o=t;return o=o.replace(/{{\s*title\s*}}/gi,e),o=o.replace(/{{\s*date(?:\s*:\s*([^}]+))?\s*}}/gi,i=>n),o=o.replace(/{{\s*dateLong\s*}}/gi,a.toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})),o=o.replace(/{{\s*weekday\s*}}/gi,xt(a)),o=o.replace(/{{\s*monthShort\s*}}/gi,Mt(a)),o=o.replace(/{{\s*year\s*}}/gi,String(Tt(a))),o=o.replace(/{{\s*isoWeek\s*}}/gi,String(vt(a))),o=o.replace(/{{\s*quarter\s*}}/gi,String(At(a))),o}function St(t,e){let a=(0,$.normalizePath)(e);return t.vault.getAbstractFileByPath(a)??null}async function P(t,e){let a=(0,$.normalizePath)(e).split("/"),n="";for(let o of a)n=n?`${n}/${o}`:o,t.vault.getAbstractFileByPath(n)||await t.vault.createFolder(n)}async function b(t,e,a){let n=(0,$.normalizePath)(e);if(!St(t,n)){let i=n.split("/").slice(0,-1).join("/");i&&await P(t,i),await t.vault.create(n,a)}}var L=require("obsidian");var k="03 SaveBox/Templates",R={area:`${k}/Area Template.md`,wish:`${k}/Wish Template.md`,goal:`${k}/Goal Template.md`,project:`${k}/Project Template.md`,task:`${k}/Task Template.md`,habit:`${k}/Habit Template.md`,note:`${k}/Note Template.md`,daily:`${k}/Daily Template.md`,weekly:`${k}/Weekly Template.md`,monthly:`${k}/Monthly Template.md`,quarterly:`${k}/Quarterly Template.md`,yearly:`${k}/Yearly Template.md`},I={area:`---
created: {{date}}
status: Active
priority: Medium
tags: []
---
# {{title}}

This page defines one part of your life that matters.
Break it into **Wishes** you\u2019d love to reach.

## Step 1 \u2013 List Your Wishes
*Use links (prefix: \`wish \`).*
- [[wish \u2013 ]]
- 
`,wish:`---
created: {{date}}
status: Active
priority: Medium
tags: []
---
# {{title}}

Break this Wish into **Goals** you control.

## Step 1 \u2013 List Your Goals
**Action + measurable outcome + timeframe**

**Examples:**
- Launch 10 products in 4 months
- Build 1,000-subscriber email list in 3 months

### \u270D\uFE0F My Goals
- [[goal \u2013 ]]
- 
`,goal:`---
created: {{date}}
status: Active
done: false
priority: Medium
tags: []
---
### My Goal
- [ ] {{title}}

Break this Goal into **Projects** (milestones).

## Step 1 \u2013 List Your Projects
**Deliverable + scope + time frame**

**Examples:**
- Build Product MVP in 4 weeks
- Create Email Launch Sequence in 6 weeks

### \u270D\uFE0F My Projects
- [[project \u2013 ]]
- 
`,project:`---
created: {{date}}
status: Active
done: false
priority: Medium
tags: []
---
### My Project
- [ ] {{title}}

Break it into **Tasks** and **Habits**.

## Tasks (\u22641h)
- [[task \u2013 ]]
- 

## Habits (repeatable)
- [[habit \u2013 ]]
- 
`,task:`---
created: 2025-10-16
_task_sync_state: false
done: false
status: Active
impact: Medium
slot: Morning
duration_hours:
tags: []
due:
---

### My Task
- [ ] {{title}}
A one-time action you can finish in about an hour.
---
### Properties to fill
- **Impact**: Select one in Properties. Options: Hi, Med, Lo.
- **duration_hours**: Set a number. Example: 0.5 or 1.
---
### Keep in mind
- Split big tasks to keep them small enough for one sitting (target 1hr max).
This way it would more friendly to your daily time budget.
---
[[Link to the daily page]]
---
<p align="center">MindMap OS \xA9 All rights reserved</p>
`,habit:`---
created: {{date}}
status: Active
done: false
priority: Medium
tags: []
---
# {{title}}

Describe the habit and frequency (e.g., daily, Mon Thu, monthly on the 1st).
`,note:`---
created: {{date}}
status: Active
tags: []
---
# {{title}}
Write freely. Link with [[...]].
`,daily:`# {{dateLong}}

## \u270D\uFE0F Inbox
- 

## Highlights
- 

## Next actions
- 
`,weekly:`# \u{1F4C5} Week {{isoWeek}} {{year}}
> Review goals and plan the week.
`,monthly:`# \u{1F4C5} {{monthShort}} {{year}}
> Review progress. Pick key projects and habits.
`,quarterly:`# \u{1F4C5} Q{{quarter}} {{year}}
> Choose focus goals. Align projects.
`,yearly:`# \u{1F4C5} Year {{year}}
> Define areas and high-level goals.
`};async function C(t,e,a,n=new Date){let o=(0,L.normalizePath)(R[e]),i=t.vault.getAbstractFileByPath(o);if(i instanceof L.TFile){console.log(`[MMOS] Using VAULT template for ${e}: ${o}`);let d=await t.vault.read(i);return _(d,a,n)}return console.log(`[MMOS] Using FALLBACK template for ${e}`),_(I[e],a,n)}async function U(t,e){let{kind:a,title:n}=e,o=e.path??Dt(a,n),i=o.substring(0,o.lastIndexOf("/"));i&&await P(t,i);let d=await C(t,a,n,new Date),s=await t.vault.create(o,d);return await t.fileManager.processFrontMatter(s,r=>{r.created??(r.created=f(new Date)),a==="task"?(r.status??(r.status="Active"),r.impact??(r.impact="Med"),r.slot??(r.slot="Morning"),r.done??(r.done=!1),r.priority??(r.priority="Medium")):a==="goal"||a==="project"||a==="habit"?(r.status??(r.status="Active"),r.done??(r.done=!1),r.priority??(r.priority="Medium")):(a==="area"||a==="note")&&(r.status??(r.status="Active"))}),s}async function Q(t){let e=["01 Definition","02 Execution/1 Daily","02 Execution/2 Weekly","02 Execution/3 Monthly","02 Execution/4 Quarterly","02 Execution/5 Yearly","03 SaveBox/Active","03 SaveBox/Archive","03 SaveBox/Attachment","03 SaveBox/Scripts","03 SaveBox/Templates","04 Output","99 System"];for(let a of e)await P(t,a);await b(t,"Welcome.md",`# \u{1F44B} Welcome to MindMap OS

Use **MindMap OS \u2192 Create Starter Structure** any time.
`),await b(t,"01 Definition/\u{1F3C1} Start Here.md",`# \u{1F3C1} MindMap OS \u2013 Start Here

### Top-Down
Areas \u2192 Goals \u2192 Projects \u2192 Tasks. Best way to start.

### Bottom-Up
Capture anything anywhere. It lands in your **Daily inbox** for linking later.

### First step
Example: [[area Health]]
- 
- 
`),await b(t,"01 Definition/\u{1F9E0} Mind Map.md",`# \u{1F9E0} Mind Map
Link Areas, Goals, Projects here.
`),await b(t,"02 Execution/\u{1F50D} Read Me First.md",`# Execution Flow
Year \u2192 Quarter \u2192 Month \u2192 Week \u2192 Day.
`),await b(t,"04 Output/Untitled.md",`# Output
Export or publish here.
`);for(let[a,n]of Object.entries(R))await b(t,n,I[a]);await b(t,"03 SaveBox/Active/\u{1F331}Area - Life.md",`---
created: ${f(new Date)}
status: Active
---
# \u{1F331}Area - Life
`),await b(t,"03 SaveBox/Active/\u{1F3AF}Goal - Launch v1.md",`---
created: ${f(new Date)}
status: Active
done: false
---
### My Goal
- [ ] \u{1F3AF}Goal - Launch v1
`),await b(t,"03 SaveBox/Active/\u{1F680}Project - Landing Page.md",`---
created: ${f(new Date)}
status: Active
done: false
---
### My Project
- [ ] \u{1F680}Project - Landing Page
`),await b(t,"03 SaveBox/Active/\u{1F4CC}Task - Draft copy.md",`---
created: ${f(new Date)}
status: Active
impact: Med
slot: Morning
done: false
priority: Medium
duration_hours:
tags: []
---
### My Task
- [ ] \u{1F4CC}Task - Draft copy
`),await b(t,"99 System/Home.md",["# Welcome to MindMap OS","","- **MindMap OS \u2192 Create Starter Structure**","- **MindMap OS \u2192 New Goal / Project / Task**","- **MindMap OS \u2192 Open Today**",""].join(`
`)),new z.Notice("\u2705 MindMap OS: starter structure updated.")}function Dt(t,e){let a=Et(e);switch(t){case"daily":return`02 Execution/1 Daily/${a}.md`;case"weekly":return`02 Execution/2 Weekly/${a}.md`;case"monthly":return`02 Execution/3 Monthly/${a}.md`;case"quarterly":return`02 Execution/4 Quarterly/${a}.md`;case"yearly":return`02 Execution/5 Yearly/${a}.md`;case"note":return`03 SaveBox/Active/${a}.md`;default:return`03 SaveBox/Active/${Ft(t)}${a}.md`}}function Ft(t){switch(t){case"area":return"\u{1F331}Area - ";case"wish":return"\u2728Wish - ";case"goal":return"\u{1F3AF}Goal - ";case"project":return"\u{1F680}Project - ";case"task":return"\u{1F4CC}Task - ";case"habit":return"\u{1F501}Habit - ";default:return""}}function Et(t){return t.replace(/[\\/:*?"<>|]/g,"").trim()}var Y=require("obsidian");var $t=["task","project","goal","area","habit","note","daily","weekly","monthly","quarterly","yearly","wish"],Pt={area:"\u{1F331}Area - ",wish:"\u2728Wish - ",goal:"\u{1F3AF}Goal - ",project:"\u{1F680}Project - ",task:"\u{1F4CC}Task - ",habit:"\u{1F504}Habit - ",note:"",daily:"",weekly:"",monthly:"",quarterly:"",yearly:""};function Lt(t){return t instanceof Y.TFile&&t.extension.toLowerCase()==="md"}function Ct(t){let e=t.match(/^(\w+)\s*(?:[-â€“]\s*|\s+)(.+)$/i);if(!e)return null;let a=e[1].toLowerCase();if(!$t.includes(a))return null;let n=e[2].trim();return{kind:a,title:n}}function Yt(t,e){let a=Ot(e);switch(t){case"daily":return`02 Execution/1 Daily/${a}.md`;case"weekly":return`02 Execution/2 Weekly/${a}.md`;case"monthly":return`02 Execution/3 Monthly/${a}.md`;case"quarterly":return`02 Execution/4 Quarterly/${a}.md`;case"yearly":return`02 Execution/5 Yearly/${a}.md`;case"note":return`03 SaveBox/Active/${a}.md`;default:return`03 SaveBox/Active/${Pt[t]}${a}.md`}}function Ot(t){return t.replace(/[\\/:*?"<>|]/g,"").trim()}async function jt(t,e,a){await t.fileManager.processFrontMatter(e,n=>{n.created??(n.created=f(new Date)),a==="task"?(n.status??(n.status="Active"),n.impact??(n.impact="Medium"),n.slot??(n.slot="Morning"),n.done??(n.done=!1),n.duration_hours??(n.duration_hours=void 0),n.tags??(n.tags=[])):a==="goal"||a==="project"||a==="habit"?(n.status??(n.status="Active"),n.done??(n.done=!1)):(a==="area"||a==="note")&&(n.status??(n.status="Active"))})}function V(t){t.vault.on("create",async e=>{try{if(!Lt(e)||(await t.vault.read(e)).trim().length>0)return;let n=e.basename,o=Ct(n);if(!o)return;let{kind:i,title:d}=o,s=await C(t,i,d,new Date);await t.vault.modify(e,s),await jt(t,e,i);let r=(0,Y.normalizePath)(Yt(i,d));r!==e.path&&await t.fileManager.renameFile(e,r),console.log(`[MMOS] wikilink routed \u2192 ${i} | ${d}`)}catch(a){console.error("[MMOS] wikilink routing error",a)}}),console.log("MMOS wikilink watcher: ON")}var J=require("obsidian");function Ht(t){return String(t).replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Bt(t,e){let a=null;return(...n)=>{a&&window.clearTimeout(a),a=window.setTimeout(()=>{a=null,t(...n)},e)}}function Z(t,e){let n=new RegExp(`^#{1,6}\\s+${Ht(e)}\\s*$`,"gim").exec(t);if(!n)return null;let o=n.index+n[0].length,i=(n[0].match(/^#+/)||["#"])[0].length,d=new RegExp(`^#{1,${i}}\\s+`,"gim");d.lastIndex=o;let s=d.exec(t);return{start:o,end:s?s.index:t.length}}var X=/^[ \t>]*[-*]\s+\[( |x|X)\]\s.*$/gim;function tt(t,e){let a=t.slice(e.start,e.end);X.lastIndex=0;let n=X.exec(a);if(!n)return null;let o=e.start+n.index,i=o+n[0].length,d=/\[(x|X)\]/.test(n[0]);return{absStart:o,absEnd:i,line:n[0],checked:d}}function et(t,e){return t.replace(/\[(?: |x|X)\]/,e?"[x]":"[ ]")}var Wt=2e3;function _t(t){return/(^|\/)(templates?|Templates?)(\/|$)/.test(t)}function Rt(t){return t?.template===!0||t?.is_template===!0||t?.type==="template"}function It(t){return/<%[\s\S]*?%>/.test(t)}function Nt(t){let e=t?.stat?.ctime??0;return Date.now()-e<Wt}function at(t){let e=new Set,a=t.vault.on("modify",r=>{e.has(r.path)&&t?.notifier?.hideAll&&t.notifier.hideAll()}),n=r=>{let u=t.workspace.getActiveViewOfType(J.MarkdownView),c=!!u&&u.file?.path===r.path&&u?.getMode()!=="preview";return{editor:u?.editor,inEdit:c}},o=async(r,u)=>{e.add(r.path);try{await t.fileManager.processFrontMatter(r,l=>{for(let c of Object.keys(u))l[c]=u[c]})}finally{e.delete(r.path)}},i=async(r,u,l,c,p)=>{let{editor:y,inEdit:h}=n(r);e.add(r.path);try{if(h&&y){let x=y.offsetToPos(l),w=y.offsetToPos(c);await new Promise(requestAnimationFrame),y.replaceRange(p,x,w)}else{let x=u.slice(0,l)+p+u.slice(c);x!==u&&await t.vault.modify(r,x)}}finally{e.delete(r.path)}},s=Bt(async()=>{let r=t.workspace.getActiveFile();if(!r||_t(r.path))return;let l=(t.metadataCache.getFileCache(r)??{}).frontmatter??{};if(Rt(l))return;let{editor:c,inEdit:p}=n(r),y=p&&c?c.getValue():await t.vault.read(r);if(!y||It(y)||!/^#{1,6}\s+My\s+(Task|Project|Goal)\s*$/im.test(y)||Nt(r)||e.has(r.path))return;let x=[{heading:"My Task",flag:"_task_sync_state"},{heading:"My Project",flag:"_project_sync_state"},{heading:"My Goal",flag:"_goal_sync_state"}];for(let w of x){let E=Z(y,w.heading);if(!E)continue;let m=tt(y,E);if(!m)continue;let g=typeof l.done=="boolean"?l.done:null,D=typeof l[w.flag]=="boolean"?l[w.flag]:null,M=m.checked;if(D===null){await o(r,{done:!!M,[w.flag]:!!M});return}let T=g!==null&&g!==D;if(M!==D){await o(r,{done:!!M,[w.flag]:!!M});return}if(T){let A=et(m.line,!!g);await i(r,y,m.absStart,m.absEnd,A),await o(r,{[w.flag]:!!g});return}return}},150);t.workspace.on("file-open",()=>s()),t.workspace.on("active-leaf-change",()=>s()),t.workspace.on("layout-change",()=>s()),t.workspace.on("editor-change",()=>s()),t.metadataCache.on("changed",()=>s()),t.metadataCache.on("resolved",()=>s()),t.vault.on("modify",()=>s()),t.vault.on("rename",()=>s()),t.vault.on("create",()=>s())}async function nt(t,e){let n=(t.metadataCache.getFileCache(e)??{}).frontmatter??{},o=!(typeof n.done=="boolean"&&n.done);await t.fileManager.processFrontMatter(e,s=>{s.done=o});let i=await t.vault.read(e),d=["My Task","My Project","My Goal"];for(let s of d){let r=Z(i,s);if(!r)continue;let u=tt(i,r);if(!u)continue;let l=et(u.line,o),c=i.slice(0,u.absStart)+l+i.slice(u.absEnd);c!==i&&await t.vault.modify(e,c);break}}var O=require("obsidian");var Kt=window.moment,N=new Set,Gt={Monday:["monday","mon","senin","sen"],Tuesday:["tuesday","tue","tues","selasa","sel"],Wednesday:["wednesday","wed","rabu","rab"],Thursday:["thursday","thu","thur","thurs","kamis","kam"],Friday:["friday","fri","jumat","jum'at","jum"],Saturday:["saturday","sat","sabtu","sab"],Sunday:["sunday","sun","minggu","ming","ahad","ahd"]},K={};for(let[t,e]of Object.entries(Gt))for(let a of e)K[a.toLowerCase()]=t;var qt=Object.keys(K).sort((t,e)=>e.length-t.length).join("|"),zt=new RegExp(`\\b(?:${qt})\\b`,"gi");function Ut(t){let a=/^#{1,6}\s*.*\blog\b.*$/mi.exec(t);return a?a.index+a[0].length:null}function Qt(t,e){let a=Ut(t);if(a===null)return t.trimEnd()+`

### \u270D\uFE0F Log

${e}
`;let n=t.slice(0,a).replace(/[ \t]+$/,""),o=t.slice(a),i=n.endsWith(`

`)?"":n.endsWith(`
`)?`
`:`

`;return n+i+e+`
`+o}function ot(t,e){let a=t.path;if(/(^|\/)(_?templates?|Templates)(\/|$)/.test(a)||/^habit template(\.md)?$/i.test(t.basename))return!1;if(/^(?:\p{Emoji_Presentation}|\p{Extended_Pictographic})?\s*Habit\s*-\s*/iu.test(t.basename))return!0;if(e){let n=e.match(/^---\r?\n([\s\S]*?)\r?\n---/);if(n&&/(^|\n)\s*type\s*:\s*habit\s*($|\n)/i.test(n[1]))return!0}return!1}function Vt(t){let e=t.match(zt);return e?[...new Set(e.map(a=>K[a.toLowerCase()]).filter(Boolean))]:[]}function Xt(t){let e=Vt(t);if(e.length===0)return!0;let a=Kt().format("dddd");return e.includes(a)}function Jt(t){let e=t.match(/^[\s\S]*?\bHabit\s*-\s*(.+)$/i);return e?e[1].trim():t.trim()}async function rt(t,e,a){let n=window.moment().format("YYYY-MM-DD"),o=`^${n}`;if(a.includes(o))return!1;let d=`- [ ] \u{1F501}Habit - ${Jt(e.basename)} ${n} ${o}`,s=Qt(a,d);return await t.vault.modify(e,s),!0}async function v(t,e){let a=e.path;if(!N.has(a)){N.add(a);try{if(!ot(e))return;if(!Xt(e.basename)){console.info("[MMOS] autolog: skip (weekly, not today)",{file:e.path});return}let n=await t.vault.read(e);if(!ot(e,n))return;await rt(t,e,n)}finally{setTimeout(()=>N.delete(a),120)}}}async function it(t,e){let a=await t.vault.read(e);await rt(t,e,a)}var Zt={area:"\u{1F331}Area - ",wish:"\u2728Wish - ",goal:"\u{1F3AF}Goal - ",project:"\u{1F680}Project - ",task:"\u{1F4CC}Task - ",habit:"\u{1F504}Habit - "};function te(t){return t.replace(/[\\/:*?"<>|]/g,"").trim()}function ee(t,e){let a=te(e);switch(t){case"daily":return`02 Execution/1 Daily/${a}.md`;case"weekly":return`02 Execution/2 Weekly/${a}.md`;case"monthly":return`02 Execution/3 Monthly/${a}.md`;case"quarterly":return`02 Execution/4 Quarterly/${a}.md`;case"yearly":return`02 Execution/5 Yearly/${a}.md`;case"note":return`03 SaveBox/Active/${a}.md`;default:return`03 SaveBox/Active/${Zt[t]}${a}.md`}}function ae(t,e){let a=t.vault.getAbstractFileByPath((0,O.normalizePath)(e));return a instanceof O.TFile?a:null}function ne(t){let e=t.trim().toLowerCase(),a=new Date;return e==="today"?f(a):e==="tomorrow"?(a.setDate(a.getDate()+1),f(a)):e==="yesterday"?(a.setDate(a.getDate()-1),f(a)):/^\d{4}-\d{2}-\d{2}$/.test(t)?t:f(a)}async function j(t,e,a){let n=a;e==="daily"&&(n=ne(a));let o=ee(e,n),i=ae(t,o);if(i){if(e==="habit")try{await v(t,i)}catch(s){console.error(s)}return await t.workspace.getLeaf(!1).openFile(i),i}let d=await U(t,{kind:e,title:n});if(e==="habit")try{await v(t,d)}catch(s){console.error(s)}return await t.workspace.getLeaf(!1).openFile(d),d}var st=(t,e)=>j(t,"task",e),ct=(t,e)=>j(t,"project",e),lt=(t,e)=>j(t,"goal",e);var dt=(t,e="today")=>j(t,"daily",e);var G=require("obsidian"),F=window.moment;function ut(t){return F(t).format("YYYY-MM-DD")}async function pt(t,e){let n=(await t.vault.read(e)).split(/\r?\n/),o=/(\d{4}-\d{2}-\d{2})(?:\s*\^\d{4}-\d{2}-\d{2})?\s*$/,i=/due\((\d{4}-\d{2}-\d{2})\)/i,d=/due::\s*(\d{4}-\d{2}-\d{2})/i,s=/ðŸ“…\s*(\d{4}-\d{2}-\d{2})/,r=[];for(let l of n){let c=l.match(/^\s*-\s\[( |x)\]\s(.*)$/i);if(!c)continue;let p=c[1].toLowerCase()==="x",y=c[2],h=y.match(o)||y.match(i)||y.match(d)||y.match(s);if(!h)continue;let x=h[1];r.push({date:x,done:p})}let u=new Map;for(let l of r)u.set(l.date,u.get(l.date)||!1||l.done);return[...u.entries()].map(([l,c])=>({date:l,done:c})).sort((l,c)=>l.date.localeCompare(c.date))}async function oe(t,e,a){let n=await pt(t,a);if(!n.length){e.createEl("p",{text:"No habit data yet."});return}let o={};for(let c of n){let p=F(c.date).format("YYYY-MM");(o[p]||(o[p]=[])).push(c)}let d=Object.keys(o).sort().slice(-3).reverse().map(c=>{let p=o[c],y=p.length?Math.round(p.filter(h=>h.done).length/p.length*100):0;return{label:F(c,"YYYY-MM").format("MMM"),pct:y}}),s=0;{let c=F();for(let p=0;p<90;p++){let y=ut(c);if(n.find(h=>h.date===y&&h.done))s++;else break;c.subtract(1,"day")}}let r=e.createDiv({cls:"habit-monthly-summary"});r.createEl("p",{text:`\u{1F525} Current streak: ${s} day${s===1?"":"s"}`});let u=r.createDiv({cls:"month-bars"});d.forEach(({label:c,pct:p},y)=>{let h=u.createDiv({cls:"month-row"});h.innerHTML=`
      <div class="month-label">${c}</div>
      <div class="bar-track"><div class="bar-fill ${y===0?"bar-orange":"bar-purple"}" style="width:${p}%;"></div></div>
      <div class="pct-text">${p}<span class="pct-symbol">%</span></div>
    `});let l=document.createElement("style");l.textContent=`
.habit-monthly-summary { margin:.75rem 0 1rem; }
.month-bars { display:flex; flex-direction:column; gap:10px; max-width:560px; }
.month-row { display:flex; align-items:center; gap:12px; width:100%; }
.month-label { width:3ch; text-align:right; font-weight:600; font-size:.95em; }

.bar-track {
  position:relative; flex:1; height:14px; border-radius:10px; overflow:hidden;
  background: color-mix(in srgb, var(--background-modifier-border) 35%, transparent);
}
.bar-fill { position:absolute; top:0; left:0; bottom:0; border-radius:10px; background: var(--interactive-accent); }
.bar-fill.bar-orange { background:#f4b56a; }

.pct-text { display:flex; align-items:baseline; gap:1px; font-weight:600; font-size:1.05em; white-space:nowrap; }
.pct-symbol { font-size:.8em; line-height:1; }
`,r.appendChild(l)}async function re(t,e,a){let n=await pt(t,a);if(!n.length){e.createEl("p",{text:"No habit tasks found."});return}let o=new Map;for(let m of n)o.set(m.date,o.get(m.date)||!1||m.done);let i=[...o.keys()].sort(),s=F().startOf("day").clone(),r=s.clone().subtract(29,"days"),u=r.clone().startOf("isoWeek"),l=s.clone().endOf("isoWeek"),c=null;for(let m=i.length-1;m>=0;m--){let g=i[m];if(!F(g).isAfter(s)&&o.get(g)){c=g;break}}let p=e.createDiv({cls:"weekly-streak-wrap"}),y=p.createDiv({cls:"weekly-streak-head"});["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].forEach(m=>y.createDiv({cls:"head",text:m}));let h=p.createDiv({cls:"weekly-streak-grid"}),x=[],w=l.clone().endOf("isoWeek");for(;w.isSameOrAfter(u);){let m=w.clone().startOf("isoWeek");x.push({weekStart:m.clone(),weekEnd:w.clone()}),w.subtract(1,"week")}for(let m of x){let g=m.weekStart.clone();for(let D=0;D<7;D++){let M=ut(g),T=g.isSameOrAfter(r)&&g.isSameOrBefore(s),B=T?!!o.get(M):!1,A=h.createDiv({cls:"weekly-streak-cell"});T||A.classList.add("pad"),B&&T&&(A.classList.add("hit"),M===c&&A.classList.add("latest-hit")),A.createDiv({cls:"num",text:T?g.format("D"):""}),A.createDiv({cls:"mmm",text:T?g.format("MMM"):""}),A.setAttr("title",T?`${g.format("ddd, DD MMM YYYY")} ${B?"\u2705 Done":"\u274C Missed"}`:""),g.add(1,"day")}}let E=document.createElement("style");E.textContent=`
.weekly-streak-wrap { margin-top:.25rem; }
.weekly-streak-head {
  display:grid; grid-template-columns: repeat(7, 1fr);
  gap:6px; max-width:520px; margin-bottom:6px;
}
.weekly-streak-head .head { text-align:center; font-size:.75em; color: var(--text-faint); }

.weekly-streak-grid { display:grid; grid-template-columns: repeat(7, 1fr); gap:6px; max-width:520px; }
.weekly-streak-cell {
  aspect-ratio:1/1; border-radius:10px; background: var(--background-modifier-border);
  display:flex; flex-direction:column; align-items:center; justify-content:center; padding-top:4px;
}
.weekly-streak-cell .num { font-weight:700; font-size:.95em; color: var(--text-muted); line-height:1.1; }
.weekly-streak-cell .mmm { font-size:.7em; color: var(--text-faint); line-height:1.1; margin-top:2px; }

.weekly-streak-cell.hit { background: var(--interactive-accent); }
.weekly-streak-cell.hit .num, .weekly-streak-cell.hit .mmm { color:white; }

.weekly-streak-cell.latest-hit { background:#f4b56a !important; }
.weekly-streak-cell.latest-hit .num, .weekly-streak-cell.latest-hit .mmm { color:white; }

.weekly-streak-cell.pad { opacity:.35; }
`,p.appendChild(E)}function yt(t,e){e("mindmapos-habit-monthly",async(a,n,o)=>{let i=t.vault.getAbstractFileByPath(o.sourcePath);i instanceof G.TFile&&await oe(t,n,i)}),e("mindmapos-habit-grid",async(a,n,o)=>{let i=t.vault.getAbstractFileByPath(o.sourcePath);i instanceof G.TFile&&await re(t,n,i)})}var ie=window.moment,se="03 SaveBox/Active",ce=/(^| )Habit -|^ðŸ”Habit -/i,le={Monday:["monday","mon","senin","sen"],Tuesday:["tuesday","tue","tues","selasa","sel"],Wednesday:["wednesday","wed","rabu","rab"],Thursday:["thursday","thu","thur","thurs","kamis","kam"],Friday:["friday","fri","jumat","jum'at","jum"],Saturday:["saturday","sat","sabtu","sab"],Sunday:["sunday","sun","minggu","ming","ahad","ahd"]},q={};for(let[t,e]of Object.entries(le))for(let a of e)q[a.toLowerCase()]=t;var de=Object.keys(q).sort((t,e)=>e.length-t.length).join("|"),ue=new RegExp(`\\b(?:${de})\\b`,"gi");function pe(t){let e=t.match(ue);return e?[...new Set(e.map(a=>q[a.toLowerCase()]).filter(Boolean))]:[]}function ye(t){let e=ie().format("dddd"),a=pe(t);return{ok:a.length>0&&a.includes(e),todayName:e}}async function mt(t,e=se){let a=t.vault.getMarkdownFiles().filter(n=>n.path.startsWith(e+"/")).filter(n=>ce.test(n.basename));for(let n of a){let{ok:o}=ye(n.basename);if(o)try{await v(t,n)}catch{}}}var H=class extends S.Plugin{async onload(){console.log("MindMap OS loaded"),V(this.app),at(this.app),yt(this.app,this.registerMarkdownCodeBlockProcessor.bind(this)),this.addCommand({id:"mmos-habits-run-autolog-today",name:"Habits: Ensure Today\u2019s Log Lines",callback:async()=>{await mt(this.app,"03 SaveBox/Active"),new S.Notice("Checked today's scheduled habits.")}});let e=async n=>{if(n)try{await v(this.app,n)}catch(o){console.error("[MindMapOS] autolog error",o)}},a=n=>{n&&(e(n),window.setTimeout(()=>e(n),150),window.setTimeout(()=>e(n),600))};this.app.workspace.onLayoutReady(()=>{let n=this.app.workspace.getActiveFile();window.setTimeout(()=>a(n),50)}),this.registerEvent(this.app.workspace.on("file-open",n=>a(n))),this.registerEvent(this.app.workspace.on("active-leaf-change",()=>{let n=this.app.workspace.getActiveFile();a(n)})),this.registerEvent(this.app.metadataCache.on("resolved",()=>{let n=this.app.workspace.getActiveFile();a(n)})),this.addCommand({id:"mmos-create-starter-structure",name:"Create Starter Structure",callback:async()=>{await Q(this.app),new S.Notice("Starter structure created.")}}),this.addCommand({id:"mmos-open-today",name:"Open Today",callback:async()=>{await dt(this.app,"today")}}),this.addCommand({id:"mmos-new-task",name:"New Task\u2026",callback:async()=>{await st(this.app,"New Task")}}),this.addCommand({id:"mmos-new-project",name:"New Project\u2026",callback:async()=>{await ct(this.app,"New Project")}}),this.addCommand({id:"mmos-new-goal",name:"New Goal\u2026",callback:async()=>{await lt(this.app,"New Goal")}}),this.addCommand({id:"mmos-toggle-done",name:"Toggle Done (YAML \u2194 checkbox)",callback:async()=>{let n=this.app.workspace.getActiveFile();n?await nt(this.app,n):new S.Notice("No active file to toggle.")}}),this.addCommand({id:"mmos-habit-force-today",name:"Habit: Add Today\u2019s Log (force)",callback:async()=>{let n=this.app.workspace.getActiveFile();if(!n)return new S.Notice("No active file.");await it(this.app,n)}}),console.log("MindMap OS ready")}onunload(){console.log("MindMap OS unloaded")}};
